<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–≥—Ä–∞ –ø—Ä–æ —Ñ–µ—Ä–º—É: –í—ã—Ä–∞—â–∏–≤–∞–Ω–∏–µ –ø—à–µ–Ω–∏—Ü—ã</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f0e5d7;
            color: #333;
            margin: 0;
            padding: 20px;
            background-image: url('https://www.transparenttextures.com/patterns/white-paper.png');
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 20px;
        }

        #main-menu {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .btn {
            padding: 10px 20px;
            margin: 5px;
            background-color: #5cb85c;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background-color: #4cae4c;
        }

        #gameContainer,
        #fieldContainer,
        #gameOverContainer {
            display: none;
            border: 2px solid #8b5a2b;
            border-radius: 10px;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            text-align: center;
            font-weight: bold;
            position: relative;
        }

        #field {
            display: grid;
            grid-template-columns: repeat(20, 30px);
            gap: 2px;
        }

        .square {
            width: 30px;
            height: 30px;
            border: 1px solid #8b5a2b;
            position: relative;
        }

        .planted {
            background-color: #c4d600;
        }

        .notPlanted {
            background-color: #9b6a4f;
        }

        .tilled {
            background-color: #5c3f2b;
        }

        .crop {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            font-size: 20px;
            line-height: 30px;
            text-align: center;
        }

        #timer {
            font-size: 1.5rem;
            color: #ff4500;
            margin: 10px 0;
        }

        #yearDisplay,
        #priceDisplay,
        #loanDisplay {
            margin: 10px 0;
        }

        .event-message {
            margin: 10px;
            font-size: 1.2rem;
            color: #d9534f;
        }

        #gameOverContainer {
            display: none; /* –°–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
            border: 2px solid #d9534f;
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body>
    <h1>–§–µ—Ä–º–∞: –í—ã—Ä–∞—â–∏–≤–∞–Ω–∏–µ –ø—à–µ–Ω–∏—Ü—ã üåæ</h1>
    <div id="main-menu">
        <button class="btn" id="playButton">–ò–≥—Ä–∞—Ç—å</button>
        <button class="btn" id="recordButton">–†–µ–∫–æ—Ä–¥–Ω—ã–π —É—Ä–æ–∂–∞–π</button>
    </div>

    <div id="gameContainer">
        <h2>–ë–∞–ª–∞–Ω—Å: <span id="balance">0</span> —Ä—É–±. | –ü—à–µ–Ω–∏—Ü–∞: <span id="wheatAmount">0</span> –∫–≥</h2>
        <h3 id="yearDisplay">–ì–æ–¥: <span id="year">1</span></h3>
        <h3 id="loanDisplay">–ö—Ä–µ–¥–∏—Ç: <span id="loanAmount">0</span> —Ä—É–±.</h3>
        <button class="btn" id="takeLoan">–í–∑—è—Ç—å –∫—Ä–µ–¥–∏—Ç</button>
        <button class="btn" id="payLoan">–í—ã–ø–ª–∞—Ç–∏—Ç—å –∫—Ä–µ–¥–∏—Ç</button>
        <div id="fieldControls" style="display: none;">
            <button class="btn" id="rentLand">–ê—Ä–µ–Ω–¥–æ–≤–∞—Ç—å –∑–µ–º–ª—é (500 —Ä—É–±–ª–µ–π / 1000 –º¬≤)</button>
            <div id="areaSelection" style="display: none;">
                <input type="number" id="landArea" placeholder="–ö–æ–ª-–≤–æ –º¬≤" />
                <button class="btn" id="confirmRent">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∞—Ä–µ–Ω–¥—É</button>
            </div>
            <button class="btn" id="openField">–ü–æ–ª–µ</button>
        </div>
        <button class="btn" id="passYear">–ü—Ä–æ–∂–∏—Ç—å –≥–æ–¥</button>
    </div>

    <div id="fieldContainer">
        <button class="btn" id="closeField">–ó–∞–∫—Ä—ã—Ç—å –ø–æ–ª–µ</button>
        <h2>–í–∞—à–µ –ø–æ–ª–µ</h2>
        <div id="timer"></div>
        <div id="field"></div>
        <div class="field-info">–ê—Ä–µ–Ω–¥–æ–≤–∞–Ω–æ: <span id="rentedArea">0</span> –≥–∞</div>
        <div class="field-info">–ü–æ—Å–µ—è–Ω–æ: <span id="plantedAreaDisplay">0</span> –≥–∞</div>
        <div class="field-info" id="priceDisplay">–¶–µ–Ω–∞ –ø—à–µ–Ω–∏—Ü—ã: <span id="currentPrice">0</span> —Ä—É–±./–∫–≥</div>
        <div class="field-info">
            <button class="btn" id="plantSeeds">–ö—É–ø–∏—Ç—å —Å–µ–º–µ–Ω–∞ (25 —Ä—É–±./–∫–≥)</button>
            <input type="number" id="seedsAmount" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (–∫–≥)" />
            <button class="btn" id="harvest">–°–æ–±—Ä–∞—Ç—å —É—Ä–æ–∂–∞–π</button>
            <button class="btn" id="plowField">–í—Å–ø–∞—Ö–∞—Ç—å –ø–æ–ª–µ</button>
            <button class="btn" id="sellHarvest">–ü—Ä–æ–¥–∞–∂–∞ –ø—à–µ–Ω–∏—Ü—ã</button>
        </div>
        <div class="event-message" id="eventMessage"></div>
    </div>

    <div id="gameOverContainer">
        <h2>–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</h2>
        <p>–í–∞—à –±–∞–ª–∞–Ω—Å –º–µ–Ω—å—à–µ –Ω—É–ª—è.</p>
        <button class="btn" id="restartButton">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
    </div>

    <script>
        let balance = 0;
        let loan = 0;
        let rentedArea = 0;
        let plantedArea = 0;
        let harvestReady = false;
        let cropYield = 0; // —É—Ä–æ–∂–∞–π –≤ –∫–≥
        let wheatAmount = 0; // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—à–µ–Ω–∏—Ü—ã –≤ –∫–≥
        let currentPrice = getRandomPrice(); // –ù–∞—á–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∑–∞ –∫–∏–ª–æ–≥—Ä–∞–º–º –ø—à–µ–Ω–∏—Ü—ã
        let plantingYear = null; // –ì–æ–¥, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª–∞ –ø–æ—Å–µ—è–Ω–∞ –ø—à–µ–Ω–∏—Ü–∞
        let year = 1; // –¢–µ–∫—É—â–∏–π –≥–æ–¥
        const MAX_LOAN = 10000; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –∫—Ä–µ–¥–∏—Ç–∞
        let highestYield = 0; // –•—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∫–æ—Ä–¥–∞ —É—Ä–æ–∂–∞—è

        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage
        function loadGame() {
            if (localStorage.getItem('farmGameData')) {
                const savedData = JSON.parse(localStorage.getItem('farmGameData'));
                balance = savedData.balance;
                loan = savedData.loan;
                rentedArea = savedData.rentedArea;
                plantedArea = savedData.plantedArea;
                wheatAmount = savedData.wheatAmount;
                year = savedData.year;
            }
        }

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ localStorage
        function saveGame() {
            const gameData = {
                balance: balance,
                loan: loan,
                rentedArea: rentedArea,
                plantedArea: plantedArea,
                wheatAmount: wheatAmount,
                year: year
            };
            localStorage.setItem('farmGameData', JSON.stringify(gameData));
        }

        function gameOver() {
            document.getElementById('gameContainer').style.display = 'none';
            document.getElementById('fieldContainer').style.display = 'none';
            document.getElementById('gameOverContainer').style.display = 'block';
        }

        document.getElementById('restartButton').addEventListener('click', () => {
            localStorage.removeItem('farmGameData'); // –û—á–∏—Å—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            resetGame(); // –°–±—Ä–æ—Å –∏–≥—Ä—ã
            document.getElementById('gameOverContainer').style.display = 'none';
            document.getElementById('main-menu').style.display = 'block'; // –ü–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
        });

        document.getElementById('playButton').addEventListener('click', () => {
            loadGame(); // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∏–≥—Ä—ã
            document.getElementById('main-menu').style.display = 'none';
            document.getElementById('gameContainer').style.display = 'block';
            resetGame();
        });

        document.getElementById('recordButton').addEventListener('click', () => {
            alert(`–°–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–∂–∞–π: ${highestYield} –∫–≥`);
        });

        document.getElementById('takeLoan').addEventListener('click', () => {
            let loanAmount = parseInt(prompt("–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –∫—Ä–µ–¥–∏—Ç–∞ (–º–∞–∫—Å–∏–º—É–º 10,000):", "1000")) || 1000;
            if (loan === 0 && loanAmount <= MAX_LOAN) {
                loan = loanAmount;
                balance += loan;
                updateLoanDisplay();
                alert(`–í—ã –≤–∑—è–ª–∏ –∫—Ä–µ–¥–∏—Ç –Ω–∞ ${loan} —Ä—É–±–ª–µ–π –ø–æ–¥ 44% –≥–æ–¥–æ–≤—ã—Ö.`);
                updateBalance();
                showRentControls();
            } else if (loan > 0) {
                alert("–£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫—Ä–µ–¥–∏—Ç.");
            } else {
                alert(`–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –∫—Ä–µ–¥–∏—Ç–∞ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç ${MAX_LOAN} —Ä—É–±–ª–µ–π.`);
            }
        });

        document.getElementById('payLoan').addEventListener('click', () => {
            if (balance >= loan) {
                balance -= loan;
                loan = 0;
                updateLoanDisplay();
                alert("–í—ã –≤—ã–ø–ª–∞—Ç–∏–ª–∏ –∫—Ä–µ–¥–∏—Ç!");
                updateBalance();
            } else {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –≤—ã–ø–ª–∞—Ç—ã –∫—Ä–µ–¥–∏—Ç–∞.");
            }
        });

        function showRentControls() {
            document.getElementById('fieldControls').style.display = 'block';
        }

        document.getElementById('rentLand').addEventListener('click', () => {
            document.getElementById('areaSelection').style.display = 'block';
        });

        document.getElementById('confirmRent').addEventListener('click', () => {
            const area = parseInt(document.getElementById('landArea').value) || 0;
            if (balance >= 500 * (area / 1000)) {
                balance -= 500 * (area / 1000);
                rentedArea += area / 10000; // –ø–µ—Ä–µ–≤–æ–¥–∏–º –≤ –≥–µ–∫—Ç–∞—Ä—ã
                alert(`–ê—Ä–µ–Ω–¥–æ–≤–∞–Ω–æ ${area / 10000} –≥–∞ –ø–æ–ª—è.`);
                document.getElementById('rentedArea').innerText = (rentedArea).toFixed(2); // –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –≥–µ–∫—Ç–∞—Ä—ã
                updateBalance();
                drawField();
            } else {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –∞—Ä–µ–Ω–¥—ã —ç—Ç–æ–π –ø–ª–æ—â–∞–¥–∏.");
            }
        });

        document.getElementById('openField').addEventListener('click', () => {
            document.getElementById('fieldContainer').style.display = 'block';
        });

        document.getElementById('passYear').addEventListener('click', () => {
            // –°–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –ø–æ –∫—Ä–µ–¥–∏—Ç—É
            if (loan > 0) {
                const interest = loan * 0.44;
                balance -= interest;
                loan += interest;
                alert(`–°–ø–∏—Å–∞–Ω–æ ${interest.toFixed(2)} —Ä—É–±. –∑–∞ –ø—Ä–æ—Ü–µ–Ω—Ç—ã –ø–æ –∫—Ä–µ–¥–∏—Ç—É.`);
            }

            year++;
            document.getElementById('year').innerText = year;

            updatePrice(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–µ–Ω—É –Ω–∞ –ø—à–µ–Ω–∏—Ü—É

            plantingYear = null;
            alert(`–ù–∞—Å—Ç—É–ø–∏–ª –≥–æ–¥: ${year}.`);
            randomEvent();
            saveGame(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥–æ–¥–∞

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —É–ø–∞–ª –ª–∏ –±–∞–ª–∞–Ω—Å –¥–æ –Ω—É–ª—è
            if (balance < 0) {
                gameOver();
            }
        });

        document.getElementById('closeField').addEventListener('click', () => {
            document.getElementById('fieldContainer').style.display = 'none';
            saveGame(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–ª—è
        });

        function updatePrice() {
            currentPrice = getRandomPrice(); // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ü–µ–Ω—ã –æ—Ç 5 –¥–æ 14 —Ä—É–±–ª–µ–π
            document.getElementById('currentPrice').innerText = formatLargeNumber(currentPrice);
        }

        function getRandomPrice() {
            return Math.floor(Math.random() * (14 - 5 + 1)) + 5; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–µ–Ω—É –æ—Ç 5 –¥–æ 14
        }

        document.getElementById('plantSeeds').addEventListener('click', () => {
            if (plantingYear === year) {
                alert("–í—ã —É–∂–µ –ø–æ—Å–µ—è–ª–∏ –≤ —ç—Ç–æ–º –≥–æ–¥—É. –ü—Ä–æ–∂–∏–≤–∏—Ç–µ –≥–æ–¥ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ—Å–µ–≤–∞.");
                return;
            }

            const seedsCost = 25; 
            const seedsToPlant = parseInt(document.getElementById('seedsAmount').value) || 0;
            const areaToPlant = seedsToPlant * 250; // –í –º¬≤

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ –∏ –ø–ª–æ—â–∞–¥–∏
            if (seedsToPlant > 0 && balance >= seedsCost * seedsToPlant && plantedArea + areaToPlant / 10000 <= rentedArea) { 
                balance -= seedsCost * seedsToPlant;
                plantingYear = year; 
                updateBalance();

                const areaPlanted = areaToPlant / 10000; // –ø–µ—Ä–µ–≤–æ–¥–∏–º –≤ –≥–µ–∫—Ç–∞—Ä—ã
                plantedArea += areaPlanted; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø–æ—Å–µ—è–Ω–Ω—É—é –ø–ª–æ—â–∞–¥—å.

                alert(`–í—ã –ø–æ—Å–µ—è–ª–∏ –ø—à–µ–Ω–∏—Ü—É –Ω–∞ ${areaToPlant} –º¬≤ (${areaPlanted} –≥–∞).`);
                
                for (let i = 0; i < Math.floor(areaPlanted * 100); i++) {
                    const square = document.querySelectorAll('.square')[i];
                    if (square) {
                        square.classList.add('planted');
                        const cropEmoji = document.createElement('div');
                        cropEmoji.className = 'crop';
                        cropEmoji.innerText = 'üåæ'; 
                        square.appendChild(cropEmoji);
                    }
                }

                let timeLeft = 30; 
                document.getElementById("timer").innerText = `–£—Ä–æ–∂–∞–π —Å–æ–∑—Ä–µ–µ—Ç —á–µ—Ä–µ–∑ ${timeLeft} —Å–µ–∫—É–Ω–¥.`;
                const timerInterval = setInterval(() => {
                    timeLeft--;
                    document.getElementById("timer").innerText = `–£—Ä–æ–∂–∞–π —Å–æ–∑—Ä–µ–µ—Ç —á–µ—Ä–µ–∑ ${timeLeft} —Å–µ–∫—É–Ω–¥.`;
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        markFieldAsReady();
                    }
                }, 1000);
            } else {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –∏–ª–∏ –∑–µ–º–ª–∏ –¥–ª—è –ø–æ—Å–∞–¥–∫–∏.");
            }
        });

        function markFieldAsReady() {
            document.querySelectorAll('.square').forEach(square => {
                if (square.classList.contains('planted')) {
                    square.style.backgroundColor = "#ffa500"; 
                }
            });

            let totalHarvest = 0;
            document.querySelectorAll('.square').forEach(square => {
                if (square.classList.contains('planted')) {
                    const randomMultiplier = (Math.random() * (1.8 - 1.3) + 1.3); 
                    totalHarvest += 1 * randomMultiplier; 
                }
            });

            cropYield = totalHarvest; 
            harvestReady = true;
            alert("–ü—à–µ–Ω–∏—Ü–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Å–±–æ—Ä—É!");
        }

        document.getElementById('harvest').addEventListener('click', () => {
            if (harvestReady) {
                const harvestAmount = Math.floor(cropYield); 
                wheatAmount += harvestAmount; 
                balance += harvestAmount * currentPrice; 
                highestYield = Math.max(highestYield, harvestAmount); 
                alert(`–í—ã —Å–æ–±—Ä–∞–ª–∏ ${harvestAmount} –∫–≥ –ø—à–µ–Ω–∏—Ü—ã!`);
                updateBalance();
                resetField();
            } else {
                alert("–£—Ä–æ–∂–∞–π –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤.");
            }
        });

        document.getElementById('sellHarvest').addEventListener('click', () => {
            if (wheatAmount > 0) {
                let sellingAmount = prompt(`–°–∫–æ–ª—å–∫–æ –∫–≥ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–∞—Ç—å? (–î–æ—Å—Ç—É–ø–Ω–æ: ${wheatAmount} –∫–≥)`);
                sellingAmount = parseInt(sellingAmount) || 0;

                if (sellingAmount > 0 && sellingAmount <= wheatAmount) {
                    balance += sellingAmount * currentPrice;
                    wheatAmount -= sellingAmount; 
                    alert(`–í—ã –ø—Ä–æ–¥–∞–ª–∏ ${sellingAmount} –∫–≥ –ø—à–µ–Ω–∏—Ü—ã!`);
                    updateBalance();
                } else {
                    alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—à–µ–Ω–∏—Ü—ã –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏.");
                }
            } else {
                alert("–°–Ω–∞—á–∞–ª–∞ —Å–æ–±–µ—Ä–∏—Ç–µ —É—Ä–æ–∂–∞–π.");
            }
        });

        document.getElementById('plowField').addEventListener('click', () => {
            const plowCost = 250 + Math.floor(rentedArea / 1000) * 250; 
            if (balance >= plowCost) {
                balance -= plowCost;
                updateBalance();
                alert("–ü–æ–ª–µ –≤—Å–ø–∞—Ö–∞–Ω–æ, —à–∞–Ω—Å—ã –Ω–∞ —É—Ä–æ–∂–∞–π —É–≤–µ–ª–∏—á–µ–Ω—ã!");
                document.querySelectorAll('.square').forEach(square => {
                    square.classList.add('tilled');
                });
            } else {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –≤—Å–ø–∞—à–∫–∏.");
            }
        });

        function resetField() {
            plantedArea = 0; // —Å–±—Ä–æ—Å –ø–æ—Å–µ—è–Ω–Ω–æ–π –∑–µ–º–ª–∏
            harvestReady = false; // —Å–±—Ä–æ—Å —Å—Ç–∞—Ç—É—Å–∞ —É—Ä–æ–∂–∞—è
            cropYield = 0; // —Å–±—Ä–æ—Å —É—Ä–æ–∂–∞—è
            document.querySelectorAll('.square').forEach(square => {
                square.classList.remove('planted');
                const cropEmoji = square.querySelector('.crop');
                if (cropEmoji) {
                    cropEmoji.remove();
                }
                square.className = "square notPlanted"; 
            });
                        document.getElementById("timer").innerText = ""; 
        }

        function drawField() {
            const field = document.getElementById('field');
            field.innerHTML = ''; 
            for (let i = 0; i < (rentedArea * 100); i++) { 
                const square = document.createElement('div');
                square.className = 'square notPlanted'; 
                field.appendChild(square);
            }
        }

        function updateBalance() {
            document.getElementById('balance').innerText = formatLargeNumber(balance);
            document.getElementById('wheatAmount').innerText = wheatAmount;
            document.getElementById('loanAmount').innerText = formatLargeNumber(loan);
            document.getElementById('plantedAreaDisplay').innerText = formatLargeNumber(plantedArea * 10000); // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤ –º¬≤
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å—Ç–∞–ª –ª–∏ –±–∞–ª–∞–Ω—Å –º–µ–Ω—å—à–µ 0
            if (balance < 0) {
                gameOver();
            }
        }

        function updateLoanDisplay() {
            document.getElementById('loanAmount').innerText = formatLargeNumber(loan);
        }

        function formatLargeNumber(num) {
            if (num >= 1e9) {
                return (num / 1e9).toFixed(1) + ' –º–ª—Ä–¥';
            } else if (num >= 1e6) {
                return (num / 1e6).toFixed(1) + ' –º–ª–Ω';
            } else if (num >= 1e3) {
                return (num / 1e3).toFixed(1) + ' —Ç—ã—Å';
            }
            return num;
        }

        // –§—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–ª—É—á–∞–π–Ω–æ–º —Å–æ–±—ã—Ç–∏–∏
        function randomEvent() {
            const event = Math.random();
            if (event < 0.2) { // 20% —à–∞–Ω—Å –Ω–∞ –ø–ª–æ—Ö–æ–µ —Å–æ–±—ã—Ç–∏–µ
                const loss = Math.floor(Math.random() * 1500 + 100);
                balance -= loss; // –°–ø–∏—Å–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤
                alert(`–ù–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –ø–æ—Ç–µ—Ä—è–ª–∏ ${loss} —Ä—É–±–ª–µ–π –∏–∑-–∑–∞ –ø—Ä–∏—Ä–æ–¥–Ω–æ–≥–æ –±–µ–¥—Å—Ç–≤–∏—è.`);
                updateBalance(); // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –ø–æ—Å–ª–µ –ø–æ—Ç–µ—Ä—å
                document.getElementById('eventMessage').innerText = `–í—ã –ø–æ—Ç–µ—Ä—è–ª–∏ ${loss} —Ä—É–±–ª–µ–π.`;
            } else if (event < 0.4) { // 20% —à–∞–Ω—Å –Ω–∞ —Ö–æ—Ä–æ—à–µ–µ —Å–æ–±—ã—Ç–∏–µ
                const gain = Math.floor(Math.random() * 1500 + 100);
                balance += gain; // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
                alert(`–£–¥–∞—á–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ! –í—ã –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∏ ${gain} —Ä—É–±–ª–µ–π –Ω–∞ –ø—Ä–æ–¥–∞–∂–µ –∏–∑–ª–∏—à–∫–æ–≤ —É—Ä–æ–∂–∞—è.`);
                updateBalance(); // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –ø–æ—Å–ª–µ –ø—Ä–∏–±—ã–ª–∏
                document.getElementById('eventMessage').innerText = `–í—ã –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∏ ${gain} —Ä—É–±–ª–µ–π.`;
            } else if (event < 0.6) { // 20% —à–∞–Ω—Å –Ω–∞ –æ—Å–æ–±–æ–µ —Å–æ–±—ã—Ç–∏–µ
                const bonus = Math.floor(Math.random() * 200 + 50);
                wheatAmount += bonus; // –î–æ–±–∞–≤–ª—è–µ–º –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø—à–µ–Ω–∏—Ü—ã
                alert(`–í—ã –ø–æ–ª—É—á–∏–ª–∏ –±–æ–Ω—É—Å: ${bonus} –∫–≥ –ø—à–µ–Ω–∏—Ü—ã!`);
                document.getElementById('eventMessage').innerText = `–í—ã –ø–æ–ª—É—á–∏–ª–∏ –±–æ–Ω—É—Å: ${bonus} –∫–≥ –ø—à–µ–Ω–∏—Ü—ã.`;
            } else {
                // –ù–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–æ–±—ã—Ç–∏—è
                document.getElementById('eventMessage').innerText = ''; // –û—á–∏—â–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏
            }
        }

        // –§—É–Ω–∫—Ü–∏—è —Å–±—Ä–æ—Å–∞ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–≥—Ä—ã
        function resetGame() {
            balance = 0;
            loan = 0;
            rentedArea = 0;
            plantedArea = 0;
            harvestReady = false;
            cropYield = 0;
            wheatAmount = 0;
            currentPrice = getRandomPrice(); // –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã
            plantingYear = null; // –û–±–Ω—É–ª–µ–Ω–∏–µ –≥–æ–¥–∞ –ø–æ—Å–µ–≤–∞
            year = 1; // –°–±—Ä–æ—Å –≥–æ–¥–∞
            highestYield = 0; // –°–±—Ä–æ—Å —Ä–µ–∫–æ—Ä–¥–∞ —É—Ä–æ–∂–∞—è

            document.getElementById('balance').innerText = formatLargeNumber(balance);
            document.getElementById('wheatAmount').innerText = wheatAmount;
            document.getElementById('loanAmount').innerText = formatLargeNumber(loan);
            document.getElementById('plantedAreaDisplay').innerText = formatLargeNumber(plantedArea * 10000); // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤ –º¬≤
            document.getElementById('year').innerText = year;

            document.getElementById('rentedArea').innerText = '0';
            drawField();
            updateBalance();
            updateLoanDisplay();
            document.getElementById('eventMessage').innerText = ''; // –û—á–∏—â–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
        drawField();
        updateBalance();
        updateLoanDisplay();
    </script>
</body>

</html>

