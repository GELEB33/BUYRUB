<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PIG Clicker</title>
  <style>
    body {
      background-image: url('https://i.yapx.ru/YDB8i.jpg');
      background-size: cover;
      color: #fff;
      font-family: 'Arial', sans-serif;
      text-align: center;
      padding: 20px;
      transition: background-color 0.5s ease;
    }
    .game-container {
      border: 5px solid #f5a9a9;
      border-radius: 15px;
      padding: 20px;
      background-color: rgba(0, 0, 0, 0.7);
      display: inline-block;
      animation: fadeIn 0.5s;
    }
    h1 {
      font-size: 48px;
      text-shadow: 2px 2px 0px black;
      border: 4px solid #f5a9a9;
      padding: 10px;
      border-radius: 10px;
      display: inline-block;
    }
    #pig-emoji {
      width: 150px;
      height: 150px;
      background-color: #f5a9a9;
      border-radius: 50%;
      position: relative;
      margin: 20px auto;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      border: 3px solid #a37171; 
      transition: transform 0.1s; 
    }
    .nose-dot {
      position: absolute;
      width: 40px;
      height: 40px;
      background-color: #402828;
      border-radius: 50%;
      border: 5px solid #a37171;
    }
    #nose-dot-left { top: 35%; left: 60%; }
    #nose-dot-right { top: 35%; right: 60%; }
    #balance, #player-name, #pig-per-click, #fact {
      font-size: 24px;
      margin: 20px;
      text-shadow: 1px 1px 0px black;
    }
    button {
      font-size: 18px;
      margin: 10px;
      padding: 10px 20px;
      background-color: #f5a9a9;
      border: 2px solid #a37171;
      border-radius: 5px;
      cursor: pointer;
      color: white;
      transition: background-color 0.3s, transform 0.2s;
    }
    button:hover {
      background-color: #e67e22; /* Изменение цвета при наведении */
      transform: scale(1.05); /* Увеличение при наведении */
    }
    button:active {
      transform: scale(0.95); /* Уменьшение при нажатии */
    }
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      background-color: white;
      color: black;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
      opacity: 0; /* Начальная непрозрачность */
      transition: opacity 0.5s ease; /* Плавный переход по непрозрачности */
    }
    #modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
    }
    #farm-window {
      display: none;
      width: 400px;
      background: url('https://i.yapx.ru/YEIk4.jpg') center/cover;
      padding: 20px;
      color: black;
      text-align: center;
      border: 3px solid #a37171;
      border-radius: 10px;
      opacity: 0; /* Начальная непрозрачность */
      transition: opacity 0.5s ease; /* Плавный переход по непрозрачности */
    }
    #farm-window h1, #farm-window #pig-count {
      color: white;
    }
    #help-button {
      font-size: 18px;
      margin: 5px;
      cursor: pointer;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-app.js";
    import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyA3uXpKy8H45C6HqiyqXECyezRGGpyHu_4",
      authDomain: "pig-cliker.firebaseapp.com",
      projectId: "pig-cliker",
      storageBucket: "pig-cliker",
      messagingSenderId: "600897676748",
      appId: "1:600897676748:web:516bde72c600f625c1a969",
      measurementId: "G-6TDRG8FD6M"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
  </script>
</head>
<body>
  <div class="game-container">
    <h1>PIG Clicker</h1>
    <div id="player-name">Имя: Не установлено</div>
    <div id="balance">Баланс: 0 pigcoin</div>
    <div id="pig-per-click">За клик: 1 pigcoin</div>
    <div id="fact">Факт: В мире почти два миллиарда свиней!</div>

    <div id="pig-emoji">
      <div id="nose-dot-left" class="nose-dot"></div>
      <div id="nose-dot-right" class="nose-dot"></div>
    </div>

    <button id="name-button">Сменить имя</button>
    <button id="upgrades-button">Улучшения</button> 
    <button id="farm-button">Ферма</button>
    <button id="help-button">?</button> <!-- Кнопка помощи -->

    <div id="modal-overlay"></div>
    <div id="upgrades-modal" class="modal">
      <h1>Улучшения</h1>
      <button id="click-upgrade">Прокачка клика (100 pigcoin)</button>
      <button id="random-pig">Рандомные pigcoin (20000 pigcoin)</button>
      <button id="buy-pig">Купить свинью (500000 pigcoin)</button>
      <button id="close-upgrades">Закрыть</button>
      <div id="click-upgrade-cost" style="margin-top: 10px;">Цена улучшения: 100 pigcoin</div>
    </div>

    <div id="farm-window">
      <h1>Ваша ферма</h1>
      <div id="pig-count">Количество свиней: 0</div>
      <button id="buy-pig-from-farm">Купить свинью (500000 pigcoin)</button>
      <button id="close-farm">Закрыть</button>
    </div>

    <!-- Модальное окно помощи -->
    <div id="help-modal" class="modal">
      <h1>Система размножения свиней</h1>
      <p>От двух свиней раз в час игры можно получить от 1 до 5 свиней.</p>
      <p>Каждая свинья предоставляет 100 pigcoin в секунду.</p>
      <button id="close-help">Закрыть</button>
    </div>
  </div>

  <script>
    const pigFacts = [
      "Свиньи очень умные животные и могут быть обучены разным трюкам.",
      "Свиньи могут обонять трюфели под землёй благодаря своему остроумному нюху.",
      "Свиньи — социальные животные и часто живут в группах.",
      "Свиньи могут развивать отношения и дружбу между собой.",
      "Свиньи имеют отличное долговременное зрение и могут видеть цвета.",
      "Одна свинья может нарожать до 32 поросят за раз.",
      "Согласно исследованиям, свиньи могут чувствовать эмоции.",
      "Это правда, что в мире живёт почти 2 миллиарда свиней.",
      "Свиньи могут издавать около 20 различных звуков."
    ];

    let pigBalance = localStorage.getItem('pigBalance') ? parseInt(localStorage.getItem('pigBalance')) : 0;
    let pigPerClick = localStorage.getItem('pigPerClick') ? parseInt(localStorage.getItem('pigPerClick')) : 1;
    let playerName = localStorage.getItem('playerName') || "";
    let pigCost = 500000;
    let clickUpgradeCost = localStorage.getItem('clickUpgradeCost') ? parseInt(localStorage.getItem('clickUpgradeCost')) : 100;
    let pigCount = localStorage.getItem('pigCount') ? parseInt(localStorage.getItem('pigCount')) : 0;

    const balanceDisplay = document.getElementById("balance");
    const pigEmoji = document.getElementById("pig-emoji");
    const playerNameDisplay = document.getElementById("player-name");
    const pigPerClickDisplay = document.getElementById("pig-per-click");
    const pigCountDisplay = document.getElementById("pig-count");
    const factDisplay = document.getElementById("fact");
    const upgradesModal = document.getElementById("upgrades-modal");
    const farmWindow = document.getElementById("farm-window");
    const helpModal = document.getElementById("help-modal");

    function updateBalance() {
      balanceDisplay.textContent = `Баланс: ${pigBalance} pigcoin`;
      localStorage.setItem('pigBalance', pigBalance);
      if (pigBalance >= 1000000000) {
        alert("Спасибо, что прошли мою игру ПУПС!");
        resetGame();
      }
    }

    function updatePlayerNameDisplay() {
      playerNameDisplay.textContent = `Имя: ${playerName || "Не установлено"}`;
      localStorage.setItem('playerName', playerName);
    }

    function updatePigPerClick() {
      pigPerClickDisplay.textContent = `За клик: ${pigPerClick} pigcoin`;
      localStorage.setItem('pigPerClick', pigPerClick);
    }

    function updateFarmDisplay() {
      pigCountDisplay.textContent = `Количество свиней: ${pigCount}`;
      localStorage.setItem('pigCount', pigCount);
    }

    function updateClickUpgradeCostDisplay() {
      const clickUpgradeText = document.getElementById("click-upgrade");
      clickUpgradeText.textContent = `Прокачка клика (${clickUpgradeCost} pigcoin)`;
      const clickUpgradeCostDisplay = document.getElementById("click-upgrade-cost");
      clickUpgradeCostDisplay.textContent = `Цена улучшения: ${clickUpgradeCost} pigcoin`;
      localStorage.setItem('clickUpgradeCost', clickUpgradeCost);
    }

    function animatePig() {
      pigEmoji.style.transform = 'scale(0.9)';
      setTimeout(() => {
        pigEmoji.style.transform = 'scale(1)';
      }, 100);
    }

    // Обработчик клика на пятачок (для ПК)
    pigEmoji.addEventListener('click', () => {
      animatePig(); 
      pigBalance += pigPerClick; 
      updateBalance();
      const randomFact = pigFacts[Math.floor(Math.random() * pigFacts.length)];
      factDisplay.textContent = randomFact;
    });

    // Обработчик касаний на пятачок (для мобильных устройств)
    pigEmoji.addEventListener('touchstart', (event) => {
      event.preventDefault();
      animatePig(); 
      const fingerCount = event.touches.length;
      const earnedCoins = pigPerClick * Math.min(fingerCount, 5);
      pigBalance += earnedCoins;
      updateBalance();
      const randomFact = pigFacts[Math.floor(Math.random() * pigFacts.length)];
      factDisplay.textContent = randomFact;
    });

    document.getElementById("click-upgrade").onclick = () => {
      if (pigBalance >= clickUpgradeCost) {
        pigBalance -= clickUpgradeCost;
        pigPerClick += 1;
        clickUpgradeCost = Math.floor(clickUpgradeCost * 1.5); 
        updateBalance();
        updatePigPerClick(); 
        updateClickUpgradeCostDisplay(); 
      } else {
        alert("Недостаточно pigcoin для прокачки!");
      }
    };

    document.getElementById("random-pig").onclick = () => {
      if (pigBalance >= 20000) {
        const randomAmount = Math.floor(Math.random() * 50000) + 1;
        pigBalance += randomAmount;
        updateBalance();
      } else {
        alert("Недостаточно pigcoin для получения рандомных pigcoin!");
      }
    };

    document.getElementById("buy-pig").onclick = () => {
      if (pigBalance >= pigCost) {
        pigBalance -= pigCost;
        pigCount += 1;
        updateFarmDisplay();
        updateBalance();
      } else {
        alert("Недостаточно pigcoin для покупки свиньи!");
      }
    };

    document.getElementById("farm-button").onclick = () => {
      farmWindow.style.display = "block";
      farmWindow.style.opacity = 1; // Устанавливаем непрозрачность на 1 для показа
      setTimeout(() => { 
        farmWindow.style.opacity = 1; 
      }, 0);
      updateFarmDisplay();
    };

    document.getElementById("close-farm").onclick = () => {
      farmWindow.style.opacity = 0; // Плавное исчезновение
      setTimeout(() => {
        farmWindow.style.display = "none"; // Прячем окно после исчезновения
      }, 500);
    };

    document.getElementById("buy-pig-from-farm").onclick = () => {
      if (pigBalance >= pigCost) {
        pigBalance -= pigCost;
        pigCount += 1;
        updateFarmDisplay();
        updateBalance();
      } else {
        alert("Недостаточно pigcoin для покупки свиньи!");
      }
    };

    document.getElementById("name-button").onclick = () => {
      const newName = prompt("Введите ваше имя:");
      if (newName) {
        playerName = newName;
        updatePlayerNameDisplay();
      }
    };

    document.getElementById("upgrades-button").onclick = () => {
      upgradesModal.style.display = "block";
      upgradesModal.style.opacity = 1; // Устанавливаем непрозрачность на 1 для показа
      setTimeout(() => { 
        upgradesModal.style.opacity = 1; 
      }, 0);
      updateClickUpgradeCostDisplay(); 
    };

    document.getElementById("close-upgrades").onclick = () => {
      upgradesModal.style.opacity = 0; // Плавное исчезновение
      setTimeout(() => {
        upgradesModal.style.display = "none"; // Прячем окно после исчезновения
      }, 500);
    };

    document.getElementById("help-button").onclick = () => {
      helpModal.style.display = "block";
      helpModal.style.opacity = 1; // Устанавливаем непрозрачность на 1 для показа
      setTimeout(() => { 
        helpModal.style.opacity = 1; 
      }, 0);
    };

    document.getElementById("close-help").onclick = () => {
      helpModal.style.opacity = 0; // Плавное исчезновение
      setTimeout(() => {
        helpModal.style.display = "none"; // Прячем окно после исчезновения
      }, 500);
    };

    function resetGame() {
      pigBalance = 0;
      pigPerClick = 1;
      clickUpgradeCost = 100;
      pigCount = 0;
      updateBalance();
      updatePigPerClick();
      updateFarmDisplay();
    }

    window.onload = () => {
      playerName = localStorage.getItem('playerName') || prompt("Введите ваше имя:") || "Не установлено";
      updatePlayerNameDisplay();
      updateFarmDisplay();
      updatePigPerClick(); 
    };

    window.onbeforeunload = () => {
      localStorage.setItem('pigBalance', pigBalance);
      localStorage.setItem('pigCount', pigCount);
      localStorage.setItem('pigPerClick', pigPerClick);
      localStorage.setItem('clickUpgradeCost', clickUpgradeCost);
      localStorage.setItem('playerName', playerName);
    };
  </script>
</body>
</html>
